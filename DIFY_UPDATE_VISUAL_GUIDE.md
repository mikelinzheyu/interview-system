# Difyå·¥ä½œæµæ›´æ–° - è¯¦ç»†å›¾æ–‡æŒ‡å—

## ğŸ“‹ æ¦‚è§ˆ

æœ¬æŒ‡å—æä¾›ä¸‰ä¸ªDifyå·¥ä½œæµçš„é€æ­¥æ›´æ–°è¯´æ˜ã€‚æ‰€æœ‰æ›´æ–°éƒ½æ¶‰åŠåœ¨Difyå·¥ä½œæµç¼–è¾‘å™¨ä¸­ä¿®æ”¹PythonèŠ‚ç‚¹ä»£ç ã€‚

**æ—¶é—´é¢„è®¡**: 30-45åˆ†é’Ÿï¼ˆä¸‰ä¸ªå·¥ä½œæµï¼‰

---

## ğŸš€ å¼€å§‹ä¹‹å‰

1. âœ… ç¡®ä¿æ‚¨å·²ç™»å½• https://cloud.dify.ai
2. âœ… ç¡®ä¿æ‚¨æœ‰æƒç¼–è¾‘è¿™ä¸‰ä¸ªå·¥ä½œæµ
3. âœ… å‡†å¤‡å¥½ä»£ç æ–‡ä»¶ï¼š
   - `dify-workflow1-code.py`
   - `dify-workflow2-code.py`
   - `dify-workflow3-code.py`

---

## âš™ï¸ é…ç½®å‚æ•°ï¼ˆæ‰€æœ‰å·¥ä½œæµéƒ½ç›¸åŒï¼‰

```
ngrokéš§é“URL: https://phrenologic-preprandial-jesica.ngrok-free.dev
APIç«¯ç‚¹: /api/sessions
APIå¯†é’¥: ak_live_a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0
éªŒè¯: verify=False (ngrokä½¿ç”¨è‡ªç­¾åè¯ä¹¦)
```

---

# å·¥ä½œæµ1 - ç”Ÿæˆé—®é¢˜

## ğŸ“ ä½ç½®è·¯å¾„

```
https://cloud.dify.ai
  â†“
é€‰æ‹©é¡¹ç›®
  â†“
å·¥ä½œæµåˆ—è¡¨
  â†“
æ‰¾åˆ° "å·¥ä½œæµ1" æˆ– "generate_questions_workflow"
  â†“
ç‚¹å‡» "ç¼–è¾‘"
```

## ğŸ” æ‰¾åˆ°PythonèŠ‚ç‚¹

åœ¨å·¥ä½œæµç¼–è¾‘å™¨ä¸­ï¼š

1. **èŠ‚ç‚¹åç§°**: "ä¿å­˜é—®é¢˜åˆ—è¡¨" æˆ–ç±»ä¼¼åç§°
2. **èŠ‚ç‚¹ç±»å‹**: Python CodeèŠ‚ç‚¹
3. **åŠŸèƒ½**: æ¥æ”¶ `job_title` å’Œ `generated_questions` ä½œä¸ºè¾“å…¥ï¼Œè°ƒç”¨å­˜å‚¨APIä¿å­˜é—®é¢˜åˆ—è¡¨

### èŠ‚ç‚¹å¤–è§‚è¯†åˆ«

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¿å­˜é—®é¢˜åˆ—è¡¨               â”‚  â† èŠ‚ç‚¹åç§°
â”‚  (Python Code)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¾“å…¥:                       â”‚
â”‚ - generated_questions       â”‚
â”‚ - job_title                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¾“å‡º:                       â”‚
â”‚ - session_id                â”‚
â”‚ - questions                 â”‚
â”‚ - question_count            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ ç¼–è¾‘æ­¥éª¤

### ç¬¬1æ­¥: æ‰“å¼€èŠ‚ç‚¹ç¼–è¾‘æ¡†

1. åŒå‡»PythonèŠ‚ç‚¹æˆ–å³é”®é€‰æ‹©"ç¼–è¾‘"
2. ä¼šçœ‹åˆ°ä»£ç ç¼–è¾‘åŒºåŸŸ

### ç¬¬2æ­¥: æ¸…ç©ºç°æœ‰ä»£ç 

1. åœ¨ç¼–è¾‘æ¡†ä¸­ï¼Œé€‰æ‹©æ‰€æœ‰ä»£ç ï¼ˆCtrl+Aï¼‰
2. åˆ é™¤ï¼ˆæŒ‰Deleteé”®ï¼‰

### ç¬¬3æ­¥: å¤åˆ¶æ–°ä»£ç 

1. æ‰“å¼€ `dify-workflow1-code.py`
2. å…¨é€‰ä»£ç ï¼ˆCtrl+Aï¼‰
3. å¤åˆ¶ï¼ˆCtrl+Cï¼‰

### ç¬¬4æ­¥: ç²˜è´´æ–°ä»£ç 

1. åœ¨Difyçš„ä»£ç ç¼–è¾‘æ¡†ä¸­ç²˜è´´ï¼ˆCtrl+Vï¼‰
2. æ£€æŸ¥ä»£ç æ˜¯å¦å®Œæ•´

### ä»£ç ç‰‡æ®µé¢„è§ˆ

```python
# å…³é”®é…ç½®
STORAGE_API_URL = "https://phrenologic-preprandial-jesica.ngrok-free.dev/api/sessions"
API_KEY = "ak_live_a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0"

# ç”Ÿæˆä¼šè¯ID
session_id = f"{uuid.uuid4().hex[:12]}-{int(datetime.now().timestamp())}"

# å‘é€è¯·æ±‚åˆ°å­˜å‚¨API
response = requests.post(
    STORAGE_API_URL,
    json=session_data,
    headers=headers,
    timeout=10,
    verify=False  # ngrokè‡ªç­¾åè¯ä¹¦
)

# è¿”å›ç»“æœ
return {
    "session_id": session_id,
    "questions": json.dumps(questions),
    "question_count": len(questions),
    "success": True
}
```

### ç¬¬5æ­¥: ä¿å­˜å¹¶å‘å¸ƒ

1. åœ¨ä»£ç ç¼–è¾‘æ¡†ä¸­ï¼Œç‚¹å‡» "âœ“ ä¿å­˜" æˆ– "å®Œæˆ"
2. è¿”å›å·¥ä½œæµç¼–è¾‘é¡µé¢
3. ç‚¹å‡»å³ä¸Šè§’ "å‘å¸ƒ" æŒ‰é’®
4. åœ¨å¼¹å‡ºçª—å£ä¸­ç¡®è®¤å‘å¸ƒ

---

# å·¥ä½œæµ2 - ç”Ÿæˆç­”æ¡ˆ

## ğŸ“ ä½ç½®è·¯å¾„

```
https://cloud.dify.ai
  â†“
é€‰æ‹©é¡¹ç›®
  â†“
å·¥ä½œæµåˆ—è¡¨
  â†“
æ‰¾åˆ° "å·¥ä½œæµ2" æˆ– "generate_answer_workflow"
  â†“
ç‚¹å‡» "ç¼–è¾‘"
```

## ğŸ” æ‰¾åˆ°PythonèŠ‚ç‚¹

åœ¨å·¥ä½œæµç¼–è¾‘å™¨ä¸­ï¼š

1. **èŠ‚ç‚¹åç§°**: "ä¿å­˜æ ‡å‡†ç­”æ¡ˆ" æˆ–ç±»ä¼¼åç§°
2. **èŠ‚ç‚¹ç±»å‹**: Python CodeèŠ‚ç‚¹
3. **åŠŸèƒ½**: æ¥æ”¶ `session_id`, `question_id`, `generated_answer` ä½œä¸ºè¾“å…¥ï¼Œä»å­˜å‚¨APIåŠ è½½é—®é¢˜å¹¶ä¿å­˜ç­”æ¡ˆ

### èŠ‚ç‚¹å¤–è§‚è¯†åˆ«

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¿å­˜æ ‡å‡†ç­”æ¡ˆ               â”‚  â† èŠ‚ç‚¹åç§°
â”‚  (Python Code)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¾“å…¥:                       â”‚
â”‚ - session_id                â”‚
â”‚ - question_id               â”‚
â”‚ - generated_answer          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¾“å‡º:                       â”‚
â”‚ - save_status               â”‚
â”‚ - generated_answer          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ ç¼–è¾‘æ­¥éª¤

### æ­¥éª¤1-4åŒå·¥ä½œæµ1

ï¼ˆæ‰“å¼€èŠ‚ç‚¹ç¼–è¾‘æ¡† â†’ æ¸…ç©ºä»£ç  â†’ å¤åˆ¶ `dify-workflow2-code.py` â†’ ç²˜è´´ä»£ç ï¼‰

### ä»£ç ç‰‡æ®µé¢„è§ˆ

```python
# é…ç½®ï¼ˆä¸å·¥ä½œæµ1ç›¸åŒï¼‰
STORAGE_API_URL = "https://phrenologic-preprandial-jesica.ngrok-free.dev/api/sessions"
API_KEY = "ak_live_a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0"

# è·å–ä¼šè¯
response = requests.get(
    f"{STORAGE_API_URL}/{session_id}",
    headers=headers,
    timeout=10,
    verify=False
)

# æ‰¾åˆ°é—®é¢˜å¹¶æ›´æ–°ç­”æ¡ˆ
question["answer"] = generated_answer
question["hasAnswer"] = True

# ä¿å­˜åˆ°å­˜å‚¨API
update_response = requests.post(
    STORAGE_API_URL,
    json=session,
    headers=headers,
    timeout=10,
    verify=False
)

return {
    "save_status": "æˆåŠŸ",
    "generated_answer": generated_answer,
    "success": True
}
```

### æ­¥éª¤5: ä¿å­˜å¹¶å‘å¸ƒ

åŒå·¥ä½œæµ1

---

# å·¥ä½œæµ3 - è¯„åˆ†

## ğŸ“ ä½ç½®è·¯å¾„

```
https://cloud.dify.ai
  â†“
é€‰æ‹©é¡¹ç›®
  â†“
å·¥ä½œæµåˆ—è¡¨
  â†“
æ‰¾åˆ° "å·¥ä½œæµ3" æˆ– "score_answer_workflow"
  â†“
ç‚¹å‡» "ç¼–è¾‘"
```

## ğŸ” æ‰¾åˆ°PythonèŠ‚ç‚¹

åœ¨å·¥ä½œæµç¼–è¾‘å™¨ä¸­ï¼š

1. **èŠ‚ç‚¹åç§°**: "è¯„åˆ†" æˆ– "è·å–æ ‡å‡†ç­”æ¡ˆ" æˆ–ç±»ä¼¼åç§°
2. **èŠ‚ç‚¹ç±»å‹**: Python CodeèŠ‚ç‚¹
3. **åŠŸèƒ½**: ä»å­˜å‚¨APIåŠ è½½æ ‡å‡†ç­”æ¡ˆï¼Œç”¨äºAIè¯„åˆ†æ¨¡å—å‚è€ƒ

### èŠ‚ç‚¹å¤–è§‚è¯†åˆ«

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è·å–æ ‡å‡†ç­”æ¡ˆ               â”‚  â† èŠ‚ç‚¹åç§°
â”‚  (Python Code)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¾“å…¥:                       â”‚
â”‚ - session_id                â”‚
â”‚ - question_id               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¾“å‡º:                       â”‚
â”‚ - overall_score             â”‚
â”‚ - comprehensive_evaluation  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ ç¼–è¾‘æ­¥éª¤

### æ­¥éª¤1-4åŒå·¥ä½œæµ1

ï¼ˆæ‰“å¼€èŠ‚ç‚¹ç¼–è¾‘æ¡† â†’ æ¸…ç©ºä»£ç  â†’ å¤åˆ¶ `dify-workflow3-code.py` â†’ ç²˜è´´ä»£ç ï¼‰

### ä»£ç ç‰‡æ®µé¢„è§ˆ

```python
# é…ç½®ï¼ˆä¸å·¥ä½œæµ1ç›¸åŒï¼‰
STORAGE_API_URL = "https://phrenologic-preprandial-jesica.ngrok-free.dev/api/sessions"
API_KEY = "ak_live_a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0"

# è·å–ä¼šè¯
response = requests.get(
    f"{STORAGE_API_URL}/{session_id}",
    headers=headers,
    timeout=10,
    verify=False
)

# æ‰¾åˆ°é—®é¢˜è·å–æ ‡å‡†ç­”æ¡ˆ
question = next(
    (q for q in session.get("questions", []) if q["id"] == question_id),
    None
)

standard_answer = question.get("answer", "")

# è¿”å›æ ‡å‡†ç­”æ¡ˆä¾›AIè¯„åˆ†ä½¿ç”¨
return {
    "overall_score": overall_score,
    "comprehensive_evaluation": comprehensive_evaluation,
    "success": True
}
```

### æ­¥éª¤5: ä¿å­˜å¹¶å‘å¸ƒ

åŒå·¥ä½œæµ1

---

## âœ… éªŒè¯æ›´æ–°å®Œæˆ

### ç¬¬1æ­¥: è¿è¡Œæµ‹è¯•è„šæœ¬

```bash
node test-workflows-complete.js
```

### ç¬¬2æ­¥: æŸ¥çœ‹æµ‹è¯•ç»“æœ

**æˆåŠŸçš„è¾“å‡ºåº”è¯¥åŒ…å«:**

```
âœ… å·¥ä½œæµ1å®Œæˆï¼
   - Session ID: abc123def456-1729000000
   - ç”Ÿæˆé—®é¢˜æ•°: 5
   - èŒä½: Pythonåç«¯å¼€å‘å·¥ç¨‹å¸ˆ

âœ… å·¥ä½œæµ2å®Œæˆï¼
   - ä¿å­˜çŠ¶æ€: æˆåŠŸ
   - ç”Ÿæˆç­”æ¡ˆé•¿åº¦: 500+ å­—ç¬¦

âœ… å·¥ä½œæµ3å®Œæˆï¼
   - ç»¼åˆè¯„åˆ†: 75/100
   - ç»¼åˆè¯„ä»·: [è¯„ä»·å†…å®¹]

âœ… å­˜å‚¨æœåŠ¡: æ•°æ®æ­£ç¡®ä¿å­˜å’Œè¯»å–
```

### ç¬¬3æ­¥: å¦‚æœå‡ºç°é—®é¢˜

æŸ¥çœ‹ `DIFY_UPDATE_GUIDE.md` ä¸­çš„æ•…éšœæ’é™¤éƒ¨åˆ†

---

## ğŸ”§ å¸¸è§é—®é¢˜å¿«é€Ÿè§£å†³

### Q: ä»£ç ç²˜è´´åå‡ºç°çº¢è‰²ä¸‹åˆ’çº¿ï¼ˆIDEè­¦å‘Šï¼‰
**A:** è¿™æ˜¯æ­£å¸¸çš„ï¼ŒDifyçš„ä»£ç ç¼–è¾‘å™¨æœ‰æ—¶ä¼šæ˜¾ç¤ºè™šå‡è­¦å‘Šã€‚ç»§ç»­ä¿å­˜å’Œå‘å¸ƒå³å¯ã€‚

### Q: å‘å¸ƒåä»ç„¶è¿”å›ç©ºæ•°æ®
**A:** æ£€æŸ¥é¡¹ï¼š
1. ä»£ç æ˜¯å¦æ­£ç¡®ä¿å­˜ï¼ˆé‡æ–°æ‰“å¼€èŠ‚ç‚¹æŸ¥çœ‹ï¼‰
2. ngrokéš§é“æ˜¯å¦ä»åœ¨è¿è¡Œï¼ˆ`curl http://localhost:4040/api/tunnels`ï¼‰
3. å­˜å‚¨APIæ˜¯å¦æ­£å¸¸ï¼ˆ`node test-storage-api.js`ï¼‰

### Q: SSLè¯ä¹¦é”™è¯¯
**A:** ç¡®ä¿ä»£ç ä¸­åŒ…å« `verify=False` å‚æ•°ï¼ˆå·²åœ¨æä¾›çš„ä»£ç ä¸­åŒ…å«ï¼‰

### Q: APIå¯†é’¥è®¤è¯å¤±è´¥
**A:** ç¡®ä¿ä½¿ç”¨çš„æ˜¯å®Œæ•´çš„APIå¯†é’¥ï¼š
```
ak_live_a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0
```

---

## ğŸ“Š æ›´æ–°è¿›åº¦è¿½è¸ª

- [ ] å·¥ä½œæµ1 - æ‰“å¼€ç¼–è¾‘å™¨
- [ ] å·¥ä½œæµ1 - æ‰¾åˆ°PythonèŠ‚ç‚¹
- [ ] å·¥ä½œæµ1 - å¤åˆ¶ä»£ç 
- [ ] å·¥ä½œæµ1 - ç²˜è´´ä»£ç 
- [ ] å·¥ä½œæµ1 - ä¿å­˜å¹¶å‘å¸ƒ

- [ ] å·¥ä½œæµ2 - æ‰“å¼€ç¼–è¾‘å™¨
- [ ] å·¥ä½œæµ2 - æ‰¾åˆ°PythonèŠ‚ç‚¹
- [ ] å·¥ä½œæµ2 - å¤åˆ¶ä»£ç 
- [ ] å·¥ä½œæµ2 - ç²˜è´´ä»£ç 
- [ ] å·¥ä½œæµ2 - ä¿å­˜å¹¶å‘å¸ƒ

- [ ] å·¥ä½œæµ3 - æ‰“å¼€ç¼–è¾‘å™¨
- [ ] å·¥ä½œæµ3 - æ‰¾åˆ°PythonèŠ‚ç‚¹
- [ ] å·¥ä½œæµ3 - å¤åˆ¶ä»£ç 
- [ ] å·¥ä½œæµ3 - ç²˜è´´ä»£ç 
- [ ] å·¥ä½œæµ3 - ä¿å­˜å¹¶å‘å¸ƒ

- [ ] è¿è¡Œæµ‹è¯•è„šæœ¬: `node test-workflows-complete.js`
- [ ] éªŒè¯æ‰€æœ‰æµ‹è¯•é€šè¿‡

---

**æç¤º**: æ ¹æ®éœ€è¦è¿”å›æ­¤æŒ‡å—ä»¥è·å–è¯¦ç»†æ­¥éª¤ã€‚

